!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ArRTM=t():e.ArRTM=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=28)}([function(e,t,n){"use strict";var r=n(1),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function E(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:s,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:E,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)E(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)E(arguments[r],n);return t},extend:function(e,t,n){return E(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(0);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),i=s.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(0),o=n(17),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=n(5)),a),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(i)})),e.exports=c}).call(this,n(16))},function(e,t,n){"use strict";var r=n(0),o=n(18),i=n(2),s=n(20),a=n(23),c=n(24),E=n(6);e.exports=function(e){return new Promise((function(t,u){var _=e.data,l=e.headers;r.isFormData(_)&&delete l["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var R=e.auth.username||"",f=e.auth.password||"";l.Authorization="Basic "+btoa(R+":"+f)}var h=s(e.baseURL,e.url);if(d.open(e.method.toUpperCase(),i(h,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?a(d.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:n,config:e,request:d};o(t,u,r),d=null}},d.onabort=function(){d&&(u(E("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){u(E("Network Error",e,null,d)),d=null},d.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),u(E(t,e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var p=n(25),N=(e.withCredentials||c(h))&&e.xsrfCookieName?p.read(e.xsrfCookieName):void 0;N&&(l[e.xsrfHeaderName]=N)}if("setRequestHeader"in d&&r.forEach(l,(function(e,t){void 0===_&&"content-type"===t.toLowerCase()?delete l[t]:d.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),u(e),d=null)})),void 0===_&&(_=null),d.send(_)}))}},function(e,t,n){"use strict";var r=n(19);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t){t=t||{};var n={},o=["url","method","params","data"],i=["headers","auth","proxy"],s=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(o,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(i,(function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):void 0!==t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):void 0!==e[o]&&(n[o]=e[o])})),r.forEach(s,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var a=o.concat(i).concat(s),c=Object.keys(t).filter((function(e){return-1===a.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e){e.exports=JSON.parse('{"name":"ar-rtm-sdk","version":"1.0.3","description":"JavaScript SDK for anyRTC RTM","main":"release/ArRTM@latest.js","typings":"release/ar-rtm-sdk.d.ts","scripts":{"build":"webpack --mode=production","dev":"webpack --mode=development","doc":"tsc & api-extractor run"},"author":"","license":"ISC","devDependencies":{"@types/js-base64":"^2.3.2","@types/wechat-miniprogram":"^3.0.0","awesome-typescript-loader":"^5.2.1","typedoc":"^0.17.7","typedoc-webpack-plugin":"^1.1.4","typescript":"^3.9.3","webpack":"^4.43.0","webpack-cli":"^3.3.11"},"dependencies":{"axios":"^0.19.2","js-base64":"^2.6.2"}}')},function(e,t,n){e.exports=n(11)},function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(12),s=n(7);function a(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=a(n(4));c.Axios=i,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=n(8),c.CancelToken=n(26),c.isCancel=n(3),c.all=function(e){return Promise.all(e)},c.spread=n(27),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(13),s=n(14),a=n(7);function c(e){this.defaults=e,this.interceptors={request:new i,response:new i}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var r=n(0);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},function(e,t,n){"use strict";var r=n(0),o=n(15),i=n(3),s=n(4);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,E=[],u=!1,_=-1;function l(){u&&c&&(u=!1,c.length?E=c.concat(E):_=-1,E.length&&d())}function d(){if(!u){var e=a(l);u=!0;for(var t=E.length;t;){for(c=E,E=[];++_<t;)c&&c[_].run();_=-1,t=E.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function R(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];E.push(new R(e,t)),1!==E.length||u||a(d)},R.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(6);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(21),o=n(22);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(0),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},function(e,t,n){"use strict";var r=n(0);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(0);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(8);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"ArRTM",(function(){return g})),n.d(t,"RtmErrorCode",(function(){return m}));var r,o,i={VERSION:n(9).version,GATEWAY_ADDRESS:"https://rtmgw.agrtc.cn",GATEWAY_CONNECT_TIMEOUT:6e3},s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},c=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},E=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.name="RTMException",this.code=e;var r=this.name.concat(" ").concat(this.code,": ");this.message=t[0]?r.concat(t[0]):r,this.data=t[1]?t[1]:{}},u=function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=e.apply(this,c([t],n))||this;return o.name="RtmInvalidArgumentError",o}return s(t,e),t}(E),_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};try{wx.getSystemInfo(),o={url:"",timeout:6e4,create:function(e){return this.url=e.baseURL,this.timeout=e.timeout,this},post:function(e,t){return l(this,void 0,void 0,(function(){var n=this;return d(this,(function(r){return[2,new Promise((function(r,o){wx.request({url:n.url+e,timeout:i.GATEWAY_CONNECT_TIMEOUT,method:"POST",header:{"content-type":"application/json"},data:t,complete:function(e){var t=e.statusCode;r(t?e:{code:-1,msg:e.errMsg})}})}))]}))}))}}}catch(e){o=n(10).default}var R,f=o,h=function(){function e(){this.appid="",this.sessionid="",this.url=i.GATEWAY_ADDRESS,this.urlSuffix="/arapi/v1?action=",this.msgSuffix="/arapi/v1/artmgw/",this.reqtInstance=f.create({baseURL:this.url,timeout:i.GATEWAY_CONNECT_TIMEOUT}),this.configServer(this.url)}return e.prototype._joinGateWay=function(e,t){return l(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,this.reqtInstance.post(e,_({},t)).then((function(e){return e.data})).catch((function(e){return Promise.resolve({code:-1,msg:e.message})}))];case 1:return[2,n.sent()]}}))}))},e.prototype.configServer=function(e){this.url=e,this.reqtInstance=f.create({baseURL:this.url,timeout:i.GATEWAY_CONNECT_TIMEOUT})},e.prototype.joinGateway=function(e){void 0===e&&(e={});var t=this;return new Promise((function(n,r){var o=t.urlSuffix.concat("wrtm_gateway");!function s(){return t._joinGateWay(o,_({},e)).then((function(o){var a=o.code;if(0===a){var c=o.sessionid,u=e.appid;t.sessionid=c,t.appid=u,n(o)}else if(-1===a)setTimeout((function(){s()}),i.GATEWAY_CONNECT_TIMEOUT);else{if(-4===a)throw r("MISSING_PARAMETER"),new Error("MISSING_PARAMETER");if(13===a)throw r("DEVELOPER_INVALID"),new E("DEVELOPER_INVALID");if(14===a)throw r("UID_BANNED"),new E("UID_BANNED");if(15===a)throw r("IP_BANNED"),new E("IP_BANNED");if(16===a)throw r("CHANNEL_BANNED"),new E("CHANNEL_BANNED");if(101===a)throw r("APPID_INVALID"),new E("APPID_INVALID");if(2002!==a)throw 109===a?(r("TOKEN_EXPIRED"),new E("TOKEN_EXPIRED","You must request a new token from your server and call join to use the new token to join the channel")):110===a?new E("TOKEN_INVALID","make sure token is right and try angain please"):(r("SERVER_ERROR"),new E("SERVER_ERROR","there are some problem whth error code : "+a));r("DEVELOPER_INVALID")}}))}()}))},e.prototype.getChanHistoryMsg=function(e){return l(this,void 0,void 0,(function(){var t,n;return d(this,(function(r){switch(r.label){case 0:return n=(t=this).msgSuffix.concat("getChanHistoryMsg"),[4,this.reqtInstance.post(n,_(_({},e),{sessId:t.sessionid,appId:t.appid})).then((function(e){return e.data}))];case 1:return[2,r.sent()]}}))}))},e.prototype.getOfflineMsg=function(e){return l(this,void 0,void 0,(function(){var t,n=this;return d(this,(function(r){return t=this,[2,new Promise((function(r,o){return l(n,void 0,void 0,(function(){var n,o;return d(this,(function(i){switch(i.label){case 0:return n=t.msgSuffix.concat("getOfflineMsg"),[4,this.reqtInstance.post(n,_(_({},e),{sessId:t.sessionid,appId:t.appid})).then((function(e){return e.data}))];case 1:return o=i.sent(),r(o),[2]}}))}))}))]}))}))},e.prototype.getP2PHistoryMsg=function(e){var t=this,n=this;return new Promise((function(r,o){return l(t,void 0,void 0,(function(){var t,o;return d(this,(function(i){switch(i.label){case 0:return t=n.msgSuffix.concat("getP2PHistoryMsg"),[4,this.reqtInstance.post(t,_(_({},e),{sessId:n.sessionid,appId:n.appid})).then((function(e){return e.data}))];case 1:return o=i.sent(),r(o),[2]}}))}))}))},e}(),p=Array.prototype,N=function(){function e(){this._events={},this.addListener=this.on}return e.prototype.getListeners=function(e){return this._events[e]?p.map.call(this._events[e],(function(e){return e.listener})):[]},e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})},e.prototype.once=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})},e.prototype.off=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&p.splice.call(n,r,1)},e.prototype.removeAllListeners=function(e){e?delete this._events[e]:this._events={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._events[e]||(this._events[e]=[]);for(var r=this._events[e],o=0;o<r.length;o+=1){var i=r[o];i.once&&this.off(e,i.listener),i.listener.apply(this,t||[])}},e.prototype._indexOfListener=function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1},e}(),T={generateLowCaseString:function(e){var t=e;void 0===t&&(t=7);var n=Math.random().toString(16).substr(2,t).toLowerCase();return n.length===t?n:n+this.generateLowCaseString(t-n.length)},generateUpperCaseString:function(e){return this.generateLowCaseString(e||32).toUpperCase()},getByteLength:function(e){for(var t=0,n=0;n<e.length;n++)e.charCodeAt(n)>255?t+=2:t++;return t}},I=function(e,t){var n="YYYY-MM-DD hh:mm:ss";if("number"!=typeof e)throw new Error("[timesToDate]: timestamp must be number");t&&"string"==typeof t&&(n=t);var r=e||Date.now(),o=new Date(r)||new Date(r),i=o.getFullYear(),s=o.getMonth()+1,a=o.getDate(),c=o.getHours(),E=o.getMinutes(),u=o.getSeconds();return n.indexOf("YYYY")>-1&&(n=n.replace("YYYY",(function(){return""+i}))),n.indexOf("MM")>-1?n=n.replace("MM",(function(){return s<10?"0"+s:""+s})):n.indexOf("M")>-1&&(n=n.replace("M",(function(){return""+s}))),n.indexOf("DD")>-1?n=n.replace("DD",(function(){return a<10?"0"+a:""+a})):n.indexOf("D")>-1&&(n=n.replace("D",(function(){return""+a}))),n.indexOf("hh")>-1?n=n.replace("hh",(function(){return c<10?"0"+c:""+c})):n.indexOf("h")>-1&&(n=n.replace("h",(function(){return""+c}))),n.indexOf("mm")>-1?n=n.replace("mm",(function(){return E<10?"0"+E:""+E})):n.indexOf("m")>-1&&(n=n.replace("m",(function(){return""+E}))),n.indexOf("ss")>-1?n=n.replace("ss",(function(){return u<10?"0"+u:""+u})):n.indexOf("s")>-1&&(n=n.replace("s",(function(){return""+u}))),n};!function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR",e[e.NONE=4]="NONE"}(R||(R={}));var O=new(function(){function e(){this.logPrefix="SupLogger",this.logLevel=R.NONE,this.uploadServeTranslators=[],this.DEBUG=R.DEBUG,this.INFO=R.INFO,this.WARNING=R.WARNING,this.ERROR=R.ERROR,this.NONE=R.NONE}return e.prototype.use=function(e){"function"==typeof e&&this.uploadServeTranslators.push((function(t,n){e(t,n)}))},e.prototype.setLogLevel=function(e,t){t&&(this.logPrefix=t),"number"==typeof e&&e>-1&&e<5&&(this.logLevel=e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>R.ERROR&&this.logLevel!==R.NONE||this.logLevel===R.NONE)){var n=e,r=Date.now();n.unshift("["+I(r,"YYYY-MM-DD hh:mm:ss")+"] %c"+this.logPrefix+" [ERROR]: ","color: #dc3545;"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:"error",params:n,timestamp:r},(function(){console.error.apply(console,n)}))})):console.error.apply(console,n)}},e.prototype.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>R.WARNING&&this.logLevel!==R.NONE||this.logLevel===R.NONE)){var n=e,r=Date.now();n.unshift("["+I(r,"YYYY-MM-DD hh:mm:ss")+"] %c"+this.logPrefix+" [WARNING]: ","color: #ffc107;"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:"warning",params:n,timestamp:r},(function(){console.warn.apply(console,n)}))})):console.warn.apply(console,n)}},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>R.INFO&&this.logLevel!==R.NONE||this.logLevel===R.NONE)){var n=e,r=Date.now();n.unshift("["+I(r,"YYYY-MM-DD hh:mm:ss")+"] %c"+this.logPrefix+" [INFO]: ","color: #6facff;"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:"info",params:n,timestamp:r},(function(){console.log.apply(console,n)}))})):console.log.apply(console,n)}},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>R.DEBUG&&this.logLevel!==R.NONE||this.logLevel===R.NONE)){var n=e,r=Date.now();n.unshift("["+I(r,"YYYY-MM-DD hh:mm:ss")+"] %c"+this.logPrefix+" [DEBUG]: ","color: #007bff;"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:"debug",params:n,timestamp:r},(function(){console.log.apply(console,n)}))})):console.log.apply(console,n)}},e}());O.setLogLevel(O.DEBUG,"anyrtc-SDK");var v,A=O,S=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();try{wx.getSystemInfo(),v=function(){function e(e){var t=this;this._events=[],this.readyState=3,this.client=wx.connectSocket({url:e}),this.readyState=0,this.client.onOpen((function(){t.readyState=1,t.onopen&&t.onopen()})),this.client.onClose((function(e,n){t.readyState=3,t.onclose&&t.onclose({code:e,reason:n})})),this.client.onMessage((function(e){t.onmessage&&t.onmessage(e)})),this.client.onError((function(e){t.readyState=3,t.onerror&&t.onerror(e)}))}return e.prototype.close=function(e,t){this.readyState=2,this.client&&this.client.close({code:e,reason:t,complete:function(){this.readyState=3}})},e.prototype.send=function(e){this.client&&1===this.readyState&&this.client.send({data:e})},e.prototype.addEventListener=function(e,t){this._events.push(t);var n=this._events[this._events.length-1];this.client.onMessage((function(e){n&&n(e)}))},e.prototype.removeEventListener=function(e,t){this._events=this._events.filter((function(e){return e!==t}))},e}()}catch(e){if(!window.WebSocket)throw new Error("System is not support WebSocket");v=window.WebSocket}var C,m,y=v,L=function(e){function t(){var t=e.call(this)||this;return t._cmdEncrypt=!1,t._appId="",t._serverIsWss=!0,t._serverUrl="",t._serverPort=0,t._webSocket=null,t._userId=null,t._connectTimeout=0,t._keepAliveTimeout=0,t._keepAiveInterval=0,t._keepAliveIntervalTime=1e4,t._revState="DISCONNECTED",t._curState="DISCONNECTED",t.handleServerEvents=function(){},t}return S(t,e),t.prototype.setAppInfo=function(e){var t=e.appId;this._appId=t},t.prototype.configServer=function(e,t,n){this._serverIsWss=e,this._serverUrl=t,this._serverPort=n},t.prototype.connectServer=function(){var e=this;return new Promise((function(t,n){if(e._webSocket)return A.error("[connectCTS] alreadly connected."),!1;var r=(e._serverIsWss?"wss":"ws")+"://"+e._serverUrl+":"+e._serverPort,o=new y(r);e._webSocket=o,e._emitConnectionState("CONNECTING"),e._setConnectTimeout(),o.onopen=function(){A.info(" serve connected..."),e._clearConnectTimeout(),e._emitConnectionState("CONNECTED"),t()},o.onmessage=function(t){var n=t.data,r=JSON.parse(n),o=r.Cmd,i=(r.Encrypt,r.Content),s=JSON.parse(i);switch(o){case"KeepAlive":e._handleKeepAlive();break;case"Login":var a=s.Code;s.UserId;0===a&&e._startKeepAlive();break;default:e.handleServerEvents&&e.handleServerEvents(o,s)}},o.onclose=function(t){var r=t.code;t.reason;switch(A.info(" serve disconnected...",r),e._clearConnectTimeout(),e._stopKeepAlive(),e._removeHandleKeepAlive(),r){case 1e3:case 1005:e._emitConnectionState("DISCONNECTED","LEAVE");break;default:"RECONNECTING"!==e._curState&&e._emitConnectionState("RECONNECTING","SERVER_ERROR")}e._webSocket=null,n()},e._webSocket.onerror=function(e){A.error("WebSocket with some error ",e)}}))},t.prototype.disconnectServer=function(e){if(e){switch(e){case"KEEP_A_LIVE_TIME_OUT":this._emitConnectionState("RECONNECTING","NETWORK_ERROR");break;case"UID_BANNED":this._emitConnectionState("DISCONNECTED","UID_BANNED")}this._stopKeepAlive(),this._removeHandleKeepAlive(),this.clearEventEmitter(),this._webSocket.onclose=null,this._webSocket=void 0}else this._webSocket&&this._webSocket.close(1e3,e)},t.prototype.clearEventEmitter=function(){this.removeAllListeners()},t.prototype.doKeepAlive=function(){var e={Cmd:"KeepAlive"};e.Encrypt=this._cmdEncrypt,e.Content=JSON.stringify({time:Date.now().toString()}),this._sendCmd(e)},t.prototype.doOnline=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("Login"===a){t._webSocket.removeEventListener("message",o);var u=E.Code,_=E.UserId;t._userId=_,0===u?n(_):r(u)}};t._webSocket.addEventListener("message",o);var i={Cmd:"Login"};i.AppId=t._appId,i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({},e)),t._sendCmd(i)}))},t.prototype.doOffline=function(){var e=this;return new Promise((function(t,n){var r=function(o){var i=o.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("Logout"===a){e._webSocket.removeEventListener("message",r);var u=E.Code;0===u?t(u):n(u)}};e._webSocket.addEventListener("message",r);var o={Cmd:"Logout"};o.Encrypt=e._cmdEncrypt,o.Content="",e._sendCmd(o)}))},t.prototype.doQueryOnlineStatus=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var r=e.data,i=JSON.parse(r),s=i.Cmd,a=(i.Encrypt,i.Content),c=JSON.parse(a);if("QueryOnlineStatus"===s){t._webSocket.removeEventListener("message",o);var E=c.Status;n(E)}};t._webSocket.addEventListener("message",o);var i={Cmd:"QueryOnlineStatus"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),t._sendCmd(i)}))},t.prototype.doQueryOnlineSubStatus=function(){var e=this;return new Promise((function(t,n){var r=function(n){var o=n.data,i=JSON.parse(o),s=i.Cmd,a=(i.Encrypt,i.Content),c=JSON.parse(a);if("QueryOnlineSubStatus"===s){e._webSocket.removeEventListener("message",r);var E=c.Status;t(E)}};e._webSocket.addEventListener("message",r);var o={Cmd:"QueryOnlineSubStatus"};o.Encrypt=e._cmdEncrypt,o.Content=JSON.stringify({MsgId:Date.now()}),e._sendCmd(o)}))},t.prototype.doSubscribeOnlineStatus=function(e){var t={Cmd:"SubscribeOnlineStatus"};t.Encrypt=this._cmdEncrypt,t.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),this._sendCmd(t)},t.prototype.doUnSubscribeOnlineStatus=function(e){var t={Cmd:"UnSubscribeOnlineStatus"};t.Encrypt=this._cmdEncrypt,t.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),this._sendCmd(t)},t.prototype.doSendMsgToPeer=function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1);var i=this;return new Promise((function(s,a){if(i._webSocket&&1===i._webSocket.readyState){var c=Date.now(),E=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,o=(n.Encrypt,n.Content),a=JSON.parse(o),u=0;if("MsgStatus"===r){var _=a.MsgId,l=a.Status;_==c&&(0===l?(i._webSocket.removeEventListener("message",E),s(!1)):1===l?u=setTimeout((function(){i._webSocket.removeEventListener("message",E),u&&clearTimeout(u),s(!1)}),1e4):2===l&&(i._webSocket.removeEventListener("message",E),u&&clearTimeout(u),s(!0)))}};i._webSocket.addEventListener("message",E);var u={Cmd:"SendMsgToPeer"};u.Encrypt=i._cmdEncrypt,u.Content=JSON.stringify(Object.assign({MsgId:c,FromUId:i._userId,ToUId:t,MsgType:e,MsgBody:n,OfflineMsg:r,HistoryMsg:o,Desc:""})),i._sendCmd(u)}else a()}))},t.prototype.doRecvMsgFromPeerAck=function(e,t){if(!this._webSocket||1!==this._webSocket.readyState)return!1;var n={Cmd:"RecvMsgFromPeerAck"};n.Encrypt=this._cmdEncrypt,n.Content=JSON.stringify(Object.assign({MsgId:e,FromUId:t})),this._sendCmd(n)},t.prototype.doAddOrUpdateUserAttributes=function(e,t){void 0===t&&(t=!1);var n=this;return new Promise((function(r,o){var i=function(e){var t=e.data,s=JSON.parse(t),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("AddOrUpdateUserAttributes"===a){n._webSocket.removeEventListener("message",i);var u=E.Code;E.MsgId;0===u?r(!0):o(u)}};n._webSocket.addEventListener("message",i);var s={Cmd:"AddOrUpdateUserAttributes"};s.Encrypt=n._cmdEncrypt,s.Content=JSON.stringify(Object.assign({MsgId:Date.now(),SetLocal:t,Attributes:JSON.stringify(e)})),n._sendCmd(s)}))},t.prototype.doDeleteUserAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("DeleteUserAttributes"===a){t._webSocket.removeEventListener("message",o);var u=E.Code;E.MsgId;0===u?n(!0):r(u)}};t._webSocket.addEventListener("message",o);var i={Cmd:"DeleteUserAttributes"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),Keys:JSON.stringify(e)})),t._sendCmd(i)}))},t.prototype.doClearUserAttributes=function(){var e=this;return new Promise((function(t,n){var r=function(o){var i=o.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("ClearUserAttributes"===a){e._webSocket.removeEventListener("message",r);var u=E.Code;E.MsgId;0===u?t(!0):n(u)}};e._webSocket.addEventListener("message",r);var o={Cmd:"ClearUserAttributes"};o.Encrypt=e._cmdEncrypt,o.Content=JSON.stringify(Object.assign({MsgId:Date.now()})),e._sendCmd(o)}))},t.prototype.doGetUserAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(r){var i=r.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("QueryAttribKeys"===a){var u=E.QueryUserId,_=(E.MsgId,E.Attribs);u===e&&(t._webSocket.removeEventListener("message",o),n(JSON.parse(""!==_?_:[])))}};t._webSocket.addEventListener("message",o);var i={Cmd:"GetUserAttributes"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),UserId:e})),t._sendCmd(i)}))},t.prototype.doGetUserAttributesByKeys=function(e,t){var n=this;return new Promise((function(r,o){var i=function(t){var o=t.data,s=JSON.parse(o),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("QueryAttribKeys"===a){var u=E.QueryUserId,_=(E.MsgId,E.Attribs);u===e&&(n._webSocket.removeEventListener("message",i),r(JSON.parse(_)))}};n._webSocket.addEventListener("message",i);var s={Cmd:"GetUserAttributes"};s.Encrypt=n._cmdEncrypt,s.Content=JSON.stringify(Object.assign({MsgId:Date.now(),UserId:e,Keys:t})),n._sendCmd(s)}))},t.prototype.doJoinChannel=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("JoinChannel"===a){t._webSocket.removeEventListener("message",o);var u=E.Code;E.ChanId;0===u?n():r(u)}};t._webSocket.addEventListener("message",o);var i={Cmd:"JoinChannel"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({ChanId:e})),t._sendCmd(i)}))},t.prototype.doSendChannelMsg=function(e,t,n,r){void 0===r&&(r=!1);var o=this;return new Promise((function(i,s){var a=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,c=(n.Encrypt,n.Content),E=JSON.parse(c);if("SendChannelMsg"===r){o._webSocket.removeEventListener("message",a);var u=E.Code;E.ChanId,E.MsgId;0===u?i():s(u)}};o._webSocket.addEventListener("message",a);var c={Cmd:"SendChannelMsg"};c.Encrypt=o._cmdEncrypt,c.Content=JSON.stringify(Object.assign({ChanId:t,FromUId:o._userId,MsgId:Date.now(),MsgType:e,MsgBody:n,HistoryMsg:r,Desc:""})),o._sendCmd(c)}))},t.prototype.doLeaveChannel=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("LeaveChannel"===a){t._webSocket.removeEventListener("message",o);var u=E.Code;E.ChanId;0===u?n():r(u)}};t._webSocket.addEventListener("message",o);var i={Cmd:"LeaveChannel"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({ChanId:e})),t._sendCmd(i)}))},t.prototype.doAddOrUpdateChanAttributes=function(e){var t=this,n=e.channelId,r=e.attributes,o=e.notify,i=void 0!==o&&o,s=e.isSet,a=void 0!==s&&s;return new Promise((function(e,o){var s=function(n){var r=n.data,i=JSON.parse(r),a=i.Cmd,c=(i.Encrypt,i.Content),E=JSON.parse(c);if("AddOrUpdateChanAttributes"===a){t._webSocket.removeEventListener("message",s);var u=E.Code;E.ChanId;0===u?e():o(u)}};t._webSocket.addEventListener("message",s);var c={Cmd:"AddOrUpdateChanAttributes"};c.Encrypt=t._cmdEncrypt,c.Content=JSON.stringify(Object.assign({MsgId:Date.now(),SetChan:a,ChanId:n,Attributes:JSON.stringify(r),Notify:i})),t._sendCmd(c)}))},t.prototype.doDeleteChanAttributes=function(e){var t=this,n=e.channelId,r=e.attributeKeys,o=e.notify;return new Promise((function(e,i){var s=function(n){var r=n.data,o=JSON.parse(r),a=o.Cmd,c=(o.Encrypt,o.Content),E=JSON.parse(c);if("DeleteChanAttributes"===a){t._webSocket.removeEventListener("message",s);var u=E.Code;E.ChanId;0===u?e():i(u)}};t._webSocket.addEventListener("message",s);var a={Cmd:"DeleteChanAttributes"};a.Encrypt=t._cmdEncrypt,a.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:n,Keys:JSON.stringify(r),Notify:o})),t._sendCmd(a)}))},t.prototype.doGetChanAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(i){var s=i.data,a=JSON.parse(s),c=a.Cmd,E=(a.Encrypt,a.Content),u=JSON.parse(E);if("GetChanAttributes"===c){var _=u.Code,l=u.ChanId,d=u.Attributes;e===l&&(t._webSocket.removeEventListener("message",o),0===_?n(JSON.parse(""===d?"[]":d)):r(_))}};t._webSocket.addEventListener("message",o);var i={Cmd:"GetChanAttributes"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e})),t._sendCmd(i)}))},t.prototype.doGetChanAttributesByKeys=function(e,t){var n=this;return new Promise((function(r,o){var i=function(t){var s=t.data,a=JSON.parse(s),c=a.Cmd,E=(a.Encrypt,a.Content),u=JSON.parse(E);if("GetChanAttributesByKeys"===c){var _=u.Code,l=u.ChanId,d=u.Attributes;e===l&&(n._webSocket.removeEventListener("message",i),0===_?r(""!==d?JSON.parse(d):[]):o(_))}};n._webSocket.addEventListener("message",i);var s={Cmd:"GetChanAttributesByKeys"};s.Encrypt=n._cmdEncrypt,s.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e,Keys:JSON.stringify(t)})),n._sendCmd(s)}))},t.prototype.doClearChanAttributes=function(e){var t=this,n=e.channelId,r=e.notify;return new Promise((function(e,o){var i=function(n){var r=n.data,s=JSON.parse(r),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("ClearChanAttributes"===a){t._webSocket.removeEventListener("message",i);var u=E.Code;E.MsgId;0===u?e(!0):o(u)}};t._webSocket.addEventListener("message",i);var s={Cmd:"ClearChanAttributes"};s.Encrypt=t._cmdEncrypt,s.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:n,Notify:r})),t._sendCmd(s)}))},t.prototype.doGetChanMemberSize=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,s=JSON.parse(i),a=s.Cmd,c=(s.Encrypt,s.Content),E=JSON.parse(c);if("GetChanMemberSize"===a){t._webSocket.removeEventListener("message",o);var u=E.Code,_=E.ChanMemSize;E.MsgId;0===u?n(_):r(u)}};t._webSocket.addEventListener("message",o);var i={Cmd:"GetChanMemberSize"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanIds:JSON.stringify(e)})),t._sendCmd(i)}))},t.prototype.doGetChanMembers=function(e){var t=this;return new Promise((function(n,r){var o=function(i){var s=i.data,a=JSON.parse(s),c=a.Cmd,E=(a.Encrypt,a.Content),u=JSON.parse(E);if("GetChanMembers"===c){var _=u.Code,l=u.Members,d=u.ChanId;u.MsgId;e===d&&(t._webSocket.removeEventListener("message",o),0===_?n(l):r(_))}};t._webSocket.addEventListener("message",o);var i={Cmd:"GetChanMembers"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e})),t._sendCmd(i)}))},t.prototype.doMakeCall=function(e,t,n){var r={Cmd:"MakeCall"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Content:n})),this._sendCmd(r)},t.prototype.doCancelCall=function(e,t,n){var r={Cmd:"CancelCall"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Content:n})),this._sendCmd(r)},t.prototype.doAcceptCall=function(e,t,n){var r={Cmd:"AcceptCall"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Response:n})),this._sendCmd(r)},t.prototype.doRefuseCall=function(e,t,n){var r={Cmd:"RejectCall"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Response:n})),this._sendCmd(r)},t.prototype._sendCmd=function(e){return 1!==this._webSocket.readyState?(A.error("[_sendCmd] rtm server is not connected."),!1):"object"!=typeof e?(A.error("[_sendCmd] msg must be object."),!1):(this._webSocket&&this._webSocket.send(JSON.stringify(e)),!0)},t.prototype._setConnectTimeout=function(){var e=this;e._clearConnectTimeout(),e._connectTimeout=setTimeout((function(){e._emitConnectionState("DISCONNECTING","NETWORK_ERROR")}),1e4)},t.prototype._startKeepAlive=function(){var e=this;e._stopKeepAlive(),e.doKeepAlive(),e._keepAiveInterval=setInterval((function(){e.doKeepAlive()}),e._keepAliveIntervalTime)},t.prototype._stopKeepAlive=function(){this._keepAiveInterval&&clearInterval(this._keepAiveInterval)},t.prototype._clearConnectTimeout=function(){this._connectTimeout&&clearTimeout(this._connectTimeout)},t.prototype._handleKeepAlive=function(){var e=this;e._removeHandleKeepAlive(),e._keepAliveTimeout=setTimeout((function(){e.disconnectServer("KEEP_A_LIVE_TIME_OUT")}),3*e._keepAliveIntervalTime)},t.prototype._removeHandleKeepAlive=function(){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout)},t.prototype._emitConnectionState=function(e,t){this._revState=this._curState,this._curState=e,this.handleServerEvents&&this.handleServerEvents("connection-state-change",{curState:this._curState,revState:this._revState,reason:t}),A.debug("["+this._userId+"] connection state change: "+this._revState+" -> "+this._curState)},t}(N);!function(e){!function(e){e.BANNED_BY_SERVER="BANNED_BY_SERVER",e.INTERRUPTED="INTERRUPTED",e.LOGIN="LOGIN",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_TIMEOUT="LOGIN_TIMEOUT",e.LOGOUT="LOGOUT",e.REMOTE_LOGIN="REMOTE_LOGIN"}(e.ConnectionChangeReason||(e.ConnectionChangeReason={})),function(e){e.ABORTED="ABORTED",e.CONNECTED="CONNECTED",e.CONNECTING="CONNECTING",e.DISCONNECTED="DISCONNECTED",e.RECONNECTING="RECONNECTING"}(e.ConnectionState||(e.ConnectionState={})),function(e){e.INVITATION_EXPIRE="INVITATION_EXPIRE",e.NOT_LOGGEDIN="NOT_LOGGEDIN",e.PEER_NO_RESPONSE="PEER_NO_RESPONSE",e.PEER_OFFLINE="PEER_OFFLINE"}(e.LocalInvitationFailureReason||(e.LocalInvitationFailureReason={})),function(e){e.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",e.CANCELED="CANCELED",e.FAILURE="FAILURE",e.IDLE="IDLE",e.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",e.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",e.SENT_TO_REMOTE="SENT_TO_REMOTE"}(e.LocalInvitationState||(e.LocalInvitationState={})),function(e){e.FILE="FILE",e.IMAGE="IMAGE",e.RAW="RAW",e.TEXT="TEXT"}(e.MessageType||(e.MessageType={})),function(e){e.OFFLINE="OFFLINE",e.ONLINE="ONLINE",e.UNREACHABLE="UNREACHABLE"}(e.PeerOnlineState||(e.PeerOnlineState={})),function(e){e.ONLINE_STATUS="ONLINE_STATUS"}(e.PeerSubscriptionOption||(e.PeerSubscriptionOption={})),function(e){e.ACCEPT_FAILURE="ACCEPT_FAILURE",e.INVITATION_EXPIRE="INVITATION_EXPIRE",e.PEER_OFFLINE="PEER_OFFLINE"}(e.RemoteInvitationFailureReason||(e.RemoteInvitationFailureReason={})),function(e){e.ACCEPTED="ACCEPTED",e.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",e.CANCELED="CANCELED",e.FAILURE="FAILURE",e.INVITATION_RECEIVED="INVITATION_RECEIVED",e.REFUSED="REFUSED"}(e.RemoteInvitationState||(e.RemoteInvitationState={}))}(C||(C={})),function(e){!function(e){e[e.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",e[e.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",e[e.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",e[e.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",e[e.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"}(e.AttributeOperationError||(e.AttributeOperationError={})),function(e){e[e.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",e[e.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",e[e.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",e[e.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",e[e.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",e[e.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(e.ChannelMessageError||(e.ChannelMessageError={})),function(e){e[e.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(e.CreateChannelError||(e.CreateChannelError={})),function(e){e[e.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(e.CreateInstanceError||(e.CreateInstanceError={})),function(e){e[e.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(e.GetChannelMemberCountErrCode||(e.GetChannelMemberCountErrCode={})),function(e){e[e.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",e[e.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",e[e.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",e[e.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",e[e.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",e[e.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=6]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(e.GetMembersError||(e.GetMembersError={})),function(e){e[e.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",e[e.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",e[e.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",e[e.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",e[e.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(e.InvitationApiCallError||(e.InvitationApiCallError={})),function(e){e[e.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",e[e.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",e[e.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",e[e.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",e[e.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",e[e.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",e[e.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=210]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=211]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(e.JoinChannelError||(e.JoinChannelError={})),function(e){e[e.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",e[e.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",e[e.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",e[e.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(e.LeaveChannelError||(e.LeaveChannelError={})),function(e){e[e.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",e[e.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",e[e.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",e[e.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",e[e.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",e[e.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",e[e.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",e[e.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",e[e.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",e[e.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",e[e.LOGIN_ERR_ABORTED_BY_LOGOUT=11]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(e.LoginError||(e.LoginError={})),function(e){e[e.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(e.LogoutError||(e.LogoutError={})),function(e){e[e.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",e[e.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",e[e.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",e[e.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",e[e.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",e[e.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(e.PeerMessageError||(e.PeerMessageError={})),function(e){e[e.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",e[e.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",e[e.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",e[e.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(e.PeerSubscriptionStatusError||(e.PeerSubscriptionStatusError={})),function(e){e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(e.QueryPeersBySubscriptionOptionError||(e.QueryPeersBySubscriptionOptionError={})),function(e){e[e.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=0]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=1]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=3]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(e.QueryPeersOnlineStatusError||(e.QueryPeersOnlineStatusError={})),function(e){e[e.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",e[e.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",e[e.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",e[e.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",e[e.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",e[e.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",e[e.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",e[e.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(e.RenewTokenError||(e.RenewTokenError={}))}(m||(m={}));var g,b,w=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},D=function(e){function t(t,n){var r=e.call(this)||this;return r.memberCount=0,r.attributes={},r.channelId="",r.client=t,r.channelId=n,r.uid=r.client.uid,r.bindChannelEvents=r._handleChannelEvents.bind(r),r}return w(t,e),t.prototype.getMembers=function(){return U(this,void 0,void 0,(function(){var e,t;return M(this,(function(n){switch(n.label){case 0:return t=(e=this).client._rtmServer,""===this.uid?[3,2]:[4,t.doGetChanMembers(e.channelId)];case 1:return[2,n.sent()];case 2:throw new u("Error Code "+m.JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,"The client is not logged in. Cannot do the operation.")}}))}))},t.prototype.join=function(){return U(this,void 0,void 0,(function(){var e,t;return M(this,(function(n){switch(n.label){case 0:if(e=this,""===this.uid)throw new u("Error Code "+m.JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,"The client is not logged in. Cannot do the operation.");return e.client.channels[e.channelId].joined?[3,3]:(t=e.client._rtmServer)?(t._webSocket.addEventListener("message",this.bindChannelEvents),[4,t.doJoinChannel(e.channelId)]):[3,2];case 1:return n.sent(),e.client.channels[e.channelId].joined=!0,e.client._gateway.getChanHistoryMsg({chanId:e.channelId}).then((function(t){var n=t.code,r=t.data;0===n&&r.map((function(t){var n=t.msgFrom,r=(t.msgStatus,t.msgType),o=t.msgBody,i={isHistoricalMessage:!0,isOfflineMessage:!1,serverReceivedTs:t.msgTs};if(1===r){var s={text:o};e.emit("ChannelMessage",s,n,i)}else if(2===r){var a={rawMessage:Base64.toUint8Array(o)};e.emit("ChannelMessage",a,n,i)}}))})).catch(),[2];case 2:return[3,4];case 3:throw new E("Error Code "+m.JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED,"The channel has joined. Cannot rejoin.");case 4:return[2]}}))}))},t.prototype.leave=function(){return U(this,void 0,void 0,(function(){var e,t,n;return M(this,(function(r){switch(r.label){case 0:if(e=this,""===this.uid)throw new u("Error Code "+m.JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,"The client is not logged in. Cannot do the operation.");return(t=e.client.channels[e.channelId]).joined?(n=e.client._rtmServer)?[4,n.doLeaveChannel(e.channelId)]:[3,2]:[3,3];case 1:return r.sent(),t.joined=!1,n._webSocket.removeEventListener("message",e.bindChannelEvents),[2];case 2:return[3,4];case 3:throw new E("Error Code "+m.LeaveChannelError.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,"The channel does not join. Cannot do the operation.");case 4:return[2]}}))}))},t.prototype.sendMessage=function(e,t){return U(this,void 0,void 0,(function(){var n,r,o,i,s,a;return M(this,(function(c){switch(c.label){case 0:if(n=this,""===this.uid)throw new u("Error Code "+m.ChannelMessageError.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,"The client is not logged in. Cannot do the operation.");return r=(t||{enableHistoricalMessaging:!1}).enableHistoricalMessaging,(o=n.client._rtmServer)?(e.description,e.messageType,i=e.text,s=e.rawMessage,i?(C.MessageType.TEXT,[4,o.doSendChannelMsg(1,n.channelId,i,r)]):[3,2]):[3,5];case 1:return c.sent(),[2];case 2:return s?(C.MessageType.RAW,a=Base64.fromUint8Array(s),[4,null==o?void 0:o.doSendChannelMsg(2,n.channelId,a,r)]):[3,4];case 3:return c.sent(),[2];case 4:throw new u("Error Code "+m.ChannelMessageError.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,"Message is not valid.");case 5:return[2]}}))}))},t.prototype._handleChannelEvents=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,o=(n.Encrypt,n.Content),i=JSON.parse(o);if(i.ChanId===this.channelId)if("RecvMsgFromChan"===r){i.MsgId;var s=i.FromUId,a=(i.ChanId,i.MsgType),c=i.MsgBody,E={isHistoricalMessage:!1,isOfflineMessage:!1,serverReceivedTs:i.SvrTS};if(1===a){var u={text:c};this.emit("ChannelMessage",u,s,E)}else if(2===a){u={rawMessage:Base64.toUint8Array(c)};this.emit("ChannelMessage",u,s,E)}}else if("ChanMemberJoin"===r){i.ChanId;var _=i.UserId;i.ChanMemSize;this.emit("MemberJoined",_)}else if("ChanMemberLeave"===r){i.ChanId,_=i.UserId,i.ChanMemSize;this.emit("MemberLeft",_)}else if("MemSizeChanged"===r){i.ChanId;var l=i.MemSize;this.emit("MemberCountUpdated",l)}else if("ChanAttribChanged"===r){i.ChanId;var d=i.Attributes,R={};d.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;R[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n}})),this.emit("AttributesUpdated",R)}},t}(N),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(e){function t(t,n,r){var o=e.call(this)||this;return o._callId="",o.calleeId="",o.content="",o.state=C.LocalInvitationState.IDLE,o.response="",o.client=t,o._callId=n,o.calleeId=r,o}return G(t,e),t.prototype.cancel=function(){var e=this.client._rtmServer;if(e)if(this.state===C.LocalInvitationState.ACCEPTED_BY_REMOTE||this.state===C.LocalInvitationState.SENT_TO_REMOTE||this.state===C.LocalInvitationState.FAILURE||this.state===C.LocalInvitationState.RECEIVED_BY_REMOTE)e.doCancelCall(this._callId,this.calleeId),this.emit("LocalInvitationCanceled");else if(this.state===C.LocalInvitationState.IDLE)throw new E("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_NOT_STARTED,"The call invitation is not send yet.")},t.prototype.send=function(){if(this.state!==C.LocalInvitationState.IDLE){if(this.state===C.LocalInvitationState.SENT_TO_REMOTE)throw new E("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_SENT,"The call invitation already sent.");if(this.state===C.LocalInvitationState.ACCEPTED_BY_REMOTE||this.state===C.LocalInvitationState.REFUSED_BY_REMOTE)throw new E("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,"The call invitation already by accept.")}var e=this.client._rtmServer;e?e.doMakeCall(this._callId,this.calleeId,this.content):this.emit("LocalInvitationFailure",C.LocalInvitationFailureReason.NOT_LOGGEDIN)},t}(N),B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(e){function t(t,n,r){var o=e.call(this)||this;return o._callId="",o.callerId="",o.content="",o.response="",o._callId=t,o.callerId=n,o.content=r,o.state=C.RemoteInvitationState.INVITATION_RECEIVED,o}return B(t,e),t.prototype.accept=function(){var e=this.client._rtmServer;if(e)if(this.state===C.RemoteInvitationState.INVITATION_RECEIVED)e.doAcceptCall(this._callId,this.callerId,this.response),this.state=C.RemoteInvitationState.ACCEPT_SENT_TO_LOCAL;else{if(this.state===C.RemoteInvitationState.ACCEPTED)throw new E("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,"The call invitation already by accept.");if(this.state===C.RemoteInvitationState.REFUSED)throw new E("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,"The call invitation already ended.")}},t.prototype.refuse=function(){var e=this.client._rtmServer;e&&this.state===C.RemoteInvitationState.INVITATION_RECEIVED&&(e.doRefuseCall(this._callId,this.callerId,this.response),this.state=C.RemoteInvitationState.REFUSED,this.emit("RemoteInvitationRefused"))},t}(N),k=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},V=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},x=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},j=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},H=function(e){function t(t,n){var r=e.call(this)||this;r._useWss=!0,r._userAttributes={},r._localCall={},r._remoteCall={},r.uid="",r.token=null,r.channels={},r.channelAttributesCacheLru={},r._sid=T.generateLowCaseString(32),r._appId=t,r._gateway=new h;var o=(n||{}).confPriCloudAddr;if(o){var s=o.ServerAdd,a=o.Port,c=o.Wss;r._useWss="boolean"!=typeof c||c,s&&(i.GATEWAY_ADDRESS=(r._useWss?"https://"+s:"http://"+s)+(a?":"+a:""),r._gateway.configServer(i.GATEWAY_ADDRESS))}return r}return k(t,e),t.prototype.addOrUpdateChannelAttributes=function(e,t,n){var r;return J(this,void 0,void 0,(function(){var o,i,s;return V(this,(function(a){switch(a.label){case 0:if(o=this,i=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");if(!i.test(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");if("[object Object]"!==Object.prototype.toString.call(t))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");if("{}"===JSON.stringify(t))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes is an empty object.");return Object.keys(t).forEach((function(e){if(null==e||""===e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","Invalid attribute key.")})),Object.values(t).map((function(e,t){if(null==e||""===e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","Invalid attribute key.")})),""===o.uid?[3,2]:(s=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doAddOrUpdateChanAttributes({channelId:e,attributes:t,notify:s})]);case 1:return a.sent(),o.channelAttributesCacheLru[e]=t,[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.addOrUpdateLocalUserAttributes=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(n=this,"[object Object]"!==Object.prototype.toString.call(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");return Object.keys(e).forEach((function(e){if(null==e||""===e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","Invalid attribute value.")})),Object.values(e).map((function(e,t){if(null==e||""===e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","Invalid attribute key.")})),""===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doAddOrUpdateUserAttributes(e)];case 1:return r.sent(),n._userAttributes=e,[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.clearChannelAttributes=function(e,t){var n;return J(this,void 0,void 0,(function(){var r,o,i;return V(this,(function(s){switch(s.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");if(!o.test(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");return""===r.uid?[3,2]:(i=(t||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(n=r._rtmServer)||void 0===n?void 0:n.doClearChanAttributes({channelId:e,notify:i})]);case 1:return s.sent(),r.channelAttributesCacheLru[e]&&delete r.channelAttributesCacheLru[e],[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.clearLocalUserAttributes=function(){var e;return J(this,void 0,void 0,(function(){var t;return V(this,(function(n){switch(n.label){case 0:return""===(t=this).uid?[3,2]:[4,null===(e=t._rtmServer)||void 0===e?void 0:e.doClearUserAttributes()];case 1:return n.sent(),t._userAttributes={},[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.createChannel=function(e){if("string"!=typeof e)throw new u("Error Code "+m.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");if(!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw new u("Error Code "+m.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");var t=new D(this,e);return this.channels[e]={channel:t,joined:!1},t},t.prototype.createLocalInvitation=function(e){if("string"!=typeof e)throw new u("Error Code "+m.InvitationApiCallError.INVITATION_API_CALL_ERR_INVALID_ARGUMENT+".","The calleeId in the arguments is invalid.");var t=T.generateLowCaseString(32),n=new P(this,t,e);return this._localCall[t]=n,n},t.prototype.deleteChannelAttributesByKeys=function(e,t,n){var r;return J(this,void 0,void 0,(function(){var o,i,s,a;return V(this,(function(c){switch(c.label){case 0:if(""===(o=this).uid)return[3,2];if(i=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");if(!i.test(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");if(!(t instanceof Array))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributeKeys in the arguments is not valid.");return s=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doDeleteChanAttributes({channelId:e,attributeKeys:t,notify:s})];case 1:return c.sent(),o.channelAttributesCacheLru[e]&&(a=o.channelAttributesCacheLru[e],Object.keys(a).map((function(e){a.hasOwnProperty(e)&&delete a[e]}))),[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.deleteLocalUserAttributesByKeys=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(n=this,!(e instanceof Array))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributeKeys in the arguments is not valid.");return""===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doDeleteUserAttributes(e)];case 1:return r.sent(),e.map((function(e){n._userAttributes.hasOwnProperty(e)&&delete n._userAttributes[e]})),[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.getChannelAttributes=function(e){var t;return J(this,void 0,void 0,(function(){var n,r,o,i,s;return V(this,(function(a){switch(a.label){case 0:if(n=this,r=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");if(!r.test(e))throw new u("Error Code "+m.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");return""===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetChanAttributes(e)];case 1:return o=a.sent(),i={},s={},o.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;i[t]=n,s[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n}})),n.channelAttributesCacheLru[e]=i,[2,s];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.getChannelAttributesByKeys=function(e,t){var n;return J(this,void 0,void 0,(function(){var r,o,i,s,a;return V(this,(function(c){switch(c.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");if(!o.test(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");if(!(t instanceof Array))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributeKeys in the arguments is not valid.");return""===r.uid?[3,2]:[4,null===(n=r._rtmServer)||void 0===n?void 0:n.doGetChanAttributesByKeys(e,t)];case 1:return i=c.sent(),s=r.channelAttributesCacheLru[e]||{},a={},i.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;a[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n},s[t]=n})),[2,a];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.getChannelMemberCount=function(e){var t;return J(this,void 0,void 0,(function(){var n,r;return V(this,(function(o){switch(o.label){case 0:if(n=this,"[object Array]"!==Object.prototype.toString.call(e))throw new u("Error Code "+m.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT+".","The channelIds in the arguments is invalid.");return""===n.uid?[3,2]:(r={},[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetChanMemberSize(e)]);case 1:return o.sent().map((function(e){r[e.ChanId]=e.MemSize})),[2,r];case 2:throw new u("Error Code "+m.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.getUserAttributes=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(n=this,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");return""===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetUserAttributes(e)];case 1:return[2,r.sent()];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.getUserAttributesByKeys=function(e,t){var n=this,r=this;return new Promise((function(o,i){return J(n,void 0,void 0,(function(){var n,i;return V(this,(function(s){switch(s.label){case 0:if(""===r.uid)return[3,2];if("string"!=typeof e||!(t instanceof Array))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","arguments is not valid.");return[4,null===(i=r._rtmServer)||void 0===i?void 0:i.doGetUserAttributesByKeys(e,t)];case 1:return n=s.sent(),o(n),[3,3];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.");case 3:return[2]}}))}))}))},t.prototype.login=function(e){var t=this,n=this;return new Promise((function(r,o){return J(t,void 0,void 0,(function(){var t,i;return V(this,(function(s){switch(s.label){case 0:if(""!==n.uid)throw new E("Error Code "+m.LoginError.LOGIN_ERR_ALREADY_LOGIN+".","The SDK is either logging in or has logged in the RTM system.");return t=e.token,i=e.uid,n._emitConnectionState(C.ConnectionState.CONNECTING,C.ConnectionChangeReason.LOGIN),n._createRtmServerIntance(),[4,n._authGateWay(i,t).catch((function(e){switch(e){case"CHANNEL_BANNED":case"IP_BANNED":case"SERVER_ERROR":case"UID_BANNED":case"DEVELOPER_INVALID":case"APP_INVALID":case"TOKEN_INVALID":break;case"TOKEN_EXPIRED":n.emit("token-privilege-did-expire"),A.info("token privilege has expire")}n._emitConnectionState(C.ConnectionState.DISCONNECTED,C.ConnectionChangeReason.LOGIN_FAILURE),o(e)}))];case 1:return s.sent()?r():o(),[2]}}))}))}))},t.prototype.logout=function(){var e;return J(this,void 0,void 0,(function(){return V(this,(function(t){switch(t.label){case 0:return""===this.uid?[3,2]:[4,null===(e=this._rtmServer)||void 0===e?void 0:e.doOffline()];case 1:return t.sent(),this.uid="",this._emitConnectionState(C.ConnectionState.DISCONNECTED,C.ConnectionChangeReason.LOGOUT),[2];case 2:throw new E("Error Code "+m.LogoutError.LOGOUT_ERR_USER_NOT_LOGGED_IN,"Logout failure. The client has already been logged out.")}}))}))},t.prototype.queryPeersBySubscriptionOption=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(""===this.uid)throw new u("Error Code "+m.QueryPeersBySubscriptionOptionError.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN,"The client is not logged in. Cannot do the operation");if(!(e in C.PeerSubscriptionOption))throw new u("Error Code "+m.QueryPeersBySubscriptionOptionError.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,"");return n=[],C.PeerSubscriptionOption.ONLINE_STATUS!==e?[3,2]:[4,null===(t=this._rtmServer)||void 0===t?void 0:t.doQueryOnlineSubStatus()];case 1:r.sent().map((function(e){1===e.Online&&n.push(e.UserId)})),r.label=2;case 2:return[2,n]}}))}))},t.prototype.queryPeersOnlineStatus=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(n={},""===this.uid)return[3,2];if(!(e instanceof Array&&e))throw new E("Error Code "+m.QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED,"invalid arguments.");return[4,null===(t=this._rtmServer)||void 0===t?void 0:t.doQueryOnlineStatus(e)];case 1:return r.sent().map((function(e){n[e.UserId]=!!e.Online})),[2,n];case 2:throw new E("Error Code "+m.QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,"The client is not logged in.")}}))}))},t.prototype.renewToken=function(e){return J(this,void 0,void 0,(function(){return V(this,(function(e){return[2]}))}))},t.prototype.sendMessageToPeer=function(e,t,n){var r;return J(this,void 0,void 0,(function(){var o,i,s,a,c,_,l;return V(this,(function(d){switch(d.label){case 0:if(i={hasPeerReceived:!1},""===(o=this).uid)return[3,4];if(!t)throw new u("Error Code "+m.PeerMessageError.PEER_MESSAGE_ERR_INVALID_USERID,"The send message arguments are not valid.");return e.description,e.messageType,s=e.text,e.rawMessage,c=(a=n||{enableHistoricalMessaging:!1,enableOfflineMessaging:!1}).enableHistoricalMessaging,_=a.enableOfflineMessaging,s?(C.MessageType.TEXT,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doSendMsgToPeer(1,t,s,_,c)]):[3,2];case 1:return l=d.sent(),i.hasPeerReceived=l,[2,i];case 2:throw new E("Error Code "+m.PeerMessageError.PEER_MESSAGE_ERR_INVALID_MESSAGE,"Message is not valid.");case 3:return[3,5];case 4:throw new E("Error Code "+m.PeerMessageError.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,"Failed to send the peer-to-peer message. The client is not logged in.");case 5:return[2]}}))}))},t.prototype.setChannelAttributes=function(e,t,n){return J(this,void 0,void 0,(function(){var r,o,i;return V(this,(function(s){switch(s.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/,"string"!=typeof e)throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The channelId in the arguments is invalid.");if(!o.test(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,");if("[object Object]"!==Object.prototype.toString.call(t))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");return""===r.uid?[3,3]:(i=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,r._rtmServer?[4,r._rtmServer.doAddOrUpdateChanAttributes({channelId:e,attributes:t,isSet:!0,notify:i})]:[3,2]);case 1:return s.sent(),r.channelAttributesCacheLru[e]=t,[2];case 2:return[3,4];case 3:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.");case 4:return[2]}}))}))},t.prototype.setLocalUserAttributes=function(e){var t;return J(this,void 0,void 0,(function(){var n;return V(this,(function(r){switch(r.label){case 0:if(n=this,"[object Object]"!==Object.prototype.toString.call(e))throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT+".","The attributes in the arguments is invalid.");return""===n.uid?[3,2]:(n._userAttributes={},[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doAddOrUpdateUserAttributes(e,!0)]);case 1:return r.sent(),n._userAttributes=e,[2];case 2:throw new u("Error Code "+m.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}}))}))},t.prototype.setParameters=function(e){var t=e.confPriCloudAddr,n=e.ConfPriCloudAddr;if(t){var r=t.ServerAdd,o=t.Port,s=t.Wss;this._useWss="boolean"!=typeof s||s,r&&(i.GATEWAY_ADDRESS=(this._useWss?"https://"+r:"http://"+r)+(o?":"+o:""),this._gateway.configServer(i.GATEWAY_ADDRESS))}if(n){r=n.ServerAdd,o=n.Port,s=n.Wss;this._useWss="boolean"!=typeof s||s,r&&(i.GATEWAY_ADDRESS=(this._useWss?"https://"+r:"http://"+r)+(o?":"+o:""),this._gateway.configServer(i.GATEWAY_ADDRESS))}},t.prototype.subscribePeersOnlineStatus=function(e){var t;return J(this,void 0,void 0,(function(){return V(this,(function(n){if(""!==this.uid){if(!(e instanceof Array&&e))throw new E("Error Code "+m.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,"invalid arguments.");return null===(t=this._rtmServer)||void 0===t||t.doSubscribeOnlineStatus(e),[2]}throw new u("Error Code "+m.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}))}))},t.prototype.unsubscribePeersOnlineStatus=function(e){var t;return J(this,void 0,void 0,(function(){return V(this,(function(n){if(""!==this.uid){if(!(e instanceof Array&&e))throw new E("Error Code "+m.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,"invalid arguments.");return null===(t=this._rtmServer)||void 0===t||t.doUnSubscribeOnlineStatus(e),[2]}throw new u("Error Code "+m.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN+".","The client is not logged in.")}))}))},t.prototype._emitConnectionState=function(e,t){this.emit("ConnectionStateChanged",e,t)},t.prototype._createRtmServerIntance=function(){var e=this;this._rtmServer||(this._rtmServer=new L),this._rtmServer.handleServerEvents=function(t,n){var r,o=e;n.Code;switch(t){case"connection-state-change":var i=n.curState;n.reason;if("RECONNECTING"===i){o._emitConnectionState(C.ConnectionState.RECONNECTING);var s=o._userAttributes;new Set;o._userAttributes={},o._remoteCall={},o._localCall={},o.channelAttributesCacheLru={},Object.keys(o.channels).map((function(e){o.channels[e].joined=!1})),o._rtmServer=void 0,o._createRtmServerIntance(),o._authGateWay(o.uid,o.token).then((function(e){o.setLocalUserAttributes(s),Object.keys(o.channels).map((function(e){var t=o.channels[e].channel;console.log(t),t.join()}))}))}break;case"ForceOffline":e._emitConnectionState(C.ConnectionState.DISCONNECTED,C.ConnectionChangeReason.REMOTE_LOGIN),e.uid="",e._rtmServer=void 0;break;case"RecvMsgFromPeer":var a=n.MsgId,c=n.FromUId,E=(n.ToUId,n.MsgType),u=n.MsgBody,_={isHistoricalMessage:!1,isOfflineMessage:!1,serverReceivedTs:n.SvrTS};if(1===E){var l={text:u};o.emit("MessageFromPeer",l,c,_)}null===(r=o._rtmServer)||void 0===r||r.doRecvMsgFromPeerAck(a,c);break;case"PeerOnlineStatus":var d=n.Status,R={};d.map((function(e){R[e.UserId]=e.Online?C.PeerOnlineState.ONLINE:C.PeerOnlineState.OFFLINE})),o.emit("PeersOnlineStatusChanged",R);break;case"MakeCall":var f=n.CallId,h=n.FromUId,p=(n.ToUId,n.Content);(I=new F(f,h,p)).client=o,o._remoteCall[f]=I,o.emit("RemoteInvitationReceived",I);break;case"CancelCall":f=n.CallId,h=n.FromUId,n.ToUId;var N=n.Reason,T=n.Response;(I=o._remoteCall[f]).state=C.RemoteInvitationState.CANCELED,N&&"Offline"===N?I.emit("RemoteInvitationFailure",C.RemoteInvitationFailureReason.PEER_OFFLINE):I.emit("RemoteInvitationCanceled",T);break;case"AcceptCallAck":var I;f=n.CallId;(I=o._remoteCall[f]).state=C.RemoteInvitationState.ACCEPTED,I.emit("RemoteInvitationAccepted");break;case"AcceptCall":f=n.CallId,h=n.FromUId,n.ToUId,T=n.Response;(O=o._localCall[f]).state=C.LocalInvitationState.ACCEPTED_BY_REMOTE,O.emit("LocalInvitationAccepted",T);break;case"RejectCall":f=n.CallId,h=n.FromUId,n.ToUId,T=n.Response;(O=o._localCall[f]).state=C.LocalInvitationState.REFUSED_BY_REMOTE,O.emit("LocalInvitationRefused",T);break;case"CallStatus":f=n.CallId,d=n.Status;var O=o._localCall[f];if(1===d)O.state=C.LocalInvitationState.SENT_TO_REMOTE;else if(2===d)O.state=C.LocalInvitationState.RECEIVED_BY_REMOTE,O.emit("LocalInvitationReceivedByPeer");else if(3===d){O.state=C.LocalInvitationState.FAILURE;var v=C.LocalInvitationFailureReason.PEER_OFFLINE;O.emit("LocalInvitationFailure",v)}else if(4===d){O.state=C.LocalInvitationState.FAILURE;var A=C.LocalInvitationFailureReason.PEER_NO_RESPONSE;O.emit("LocalInvitationFailure",A),o._localCall[f].cancel()}}}},t.prototype._authGateWay=function(e,t){var n;return J(this,void 0,void 0,(function(){var r,o,s,a,c,u,_,l,d,R,f;return V(this,(function(h){switch(h.label){case 0:return[4,(r=this)._gateway.joinGateway({appid:r._appId,uid:e,token:t||"",wss:r._useWss})];case 1:if(o=h.sent(),r.token=t,!(s=o.addresses)||s instanceof Array&&0===s.length)throw new E("Error Code "+m.LoginError.LOGIN_ERR_UNKNOWN,"Can not find service list");return[4,r._connectRtmServer(o)];case 2:return h.sent(),a={UserId:e,UserSId:r._sid,AcsToken:t||"",SdkVer:i.VERSION,SessionId:r._gateway.sessionid},[4,null===(n=r._rtmServer)||void 0===n?void 0:n.doOnline(a).catch((function(e){var t;null===(t=r._rtmServer)||void 0===t||t.disconnectServer(),r._emitConnectionState(C.ConnectionState.DISCONNECTED,C.ConnectionChangeReason.LOGIN_FAILURE)}))];case 3:return c=h.sent(),r.uid=c,r._emitConnectionState(C.ConnectionState.CONNECTED,C.ConnectionChangeReason.LOGIN_SUCCESS),[4,Promise.all([r._gateway.getOfflineMsg({uid:r.uid}),r._gateway.getP2PHistoryMsg({fromUId:r.uid})])];case 4:return u=x.apply(void 0,[h.sent(),2]),_=u[0],l=u[1],_&&(R=_.code,d=_.data,0===R&&d.map((function(e){var t=e.msgFrom,n=(e.msgStatus,e.msgType),o=e.msgBody,i={isHistoricalMessage:!1,isOfflineMessage:!0,serverReceivedTs:e.msgTs};if(1===n){var s={text:o};r.emit("MessageFromPeer",s,t,i)}}))),l&&(R=l.code,f=l.data,0===R&&f.map((function(e){var t=e.msgFrom,n=(e.msgStatus,e.msgType),o=e.msgBody,i={isHistoricalMessage:!0,isOfflineMessage:!1,serverReceivedTs:e.msgTs};if(1===n){var s={text:o};r.emit("MessageFromPeer",s,t,i)}}))),[2,r.uid]}}))}))},t.prototype._connectRtmServer=function(e){return J(this,void 0,void 0,(function(){var t,n,r,o=this;return V(this,(function(i){return t=this,n=e.addresses,e.sessionid,r=n.filter((function(e){return 0===e.type})),[2,new Promise((function(e,n){return J(o,void 0,void 0,(function(){var n,o,i,s,a,c,E,u,_;return V(this,(function(l){switch(l.label){case 0:if(!1,!(r.length>0))return[3,9];l.label=1;case 1:l.trys.push([1,6,7,8]),n=j(r),o=n.next(),l.label=2;case 2:return o.done?[3,5]:(i=o.value,A.debug("begin connect media server ",i),null===(E=t._rtmServer)||void 0===E||E.setAppInfo({appId:t._appId}),null===(u=t._rtmServer)||void 0===u||u.configServer(t._useWss,i.addr,i.port),[4,null===(_=t._rtmServer)||void 0===_?void 0:_.connectServer()]);case 3:return l.sent(),e(),!0,[3,5];case 4:return o=n.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),a={error:s},[3,8];case 7:try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(a)throw a.error}return[7];case 8:return[3,10];case 9:console.log("CAN_NOT_GET_GATEWAY_SERVER"),l.label=10;case 10:return[2]}}))}))}))]}))}))},t}(N);(b=g||(g={})).BUILD="",b.ConnectionChangeReason=void 0,b.ConnectionState=void 0,b.END_CALL_PREFIX="",b.LOG_FILTER_ERROR="LOG_FILTER_ERROR",b.LOG_FILTER_INFO="LOG_FILTER_INFO",b.LOG_FILTER_OFF="LOG_FILTER_OFF",b.LOG_FILTER_WARNING="LOG_FILTER_WARNING",b.LocalInvitationState=void 0,b.MessageType=void 0,b.PeerOnlineState=void 0,b.PeerSubscriptionOption=void 0,b.RemoteInvitationFailureReason=void 0,b.LocalInvitationFailureReason=void 0,b.RemoteInvitationState=void 0,b.VERSION=i.VERSION,b.createInstance=function(e,t){if(!/^[a-zA-Z0-9]{32}$/.test(e))throw new u("Error Code "+m.CreateInstanceError.CREATE_INSTANCE_ERR_INVALID_ARGUMENT+".","The appId in the arguments is invalid.");var n=(t||{}).logFilter;if(n){var r=["","LOG_FILTER_INFO","LOG_FILTER_WARNING","LOG_FILTER_ERROR","LOG_FILTER_OFF"],o=4;~r.indexOf(n)&&(o=r.findIndex((function(e){return e===n}))),A.setLogLevel(o,"anyrtc-SDK")}return new H(e,t)};t.default=g}]).default}));